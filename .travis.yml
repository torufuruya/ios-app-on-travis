language: objective-c
osx_image: xcode10
xcode_project: ios-app-on-travis.xcodeproj
xcode_scheme: ios-app-on-travisTests

jobs:
    include:
        - stage: compile
          script: echo 'compiling...'
        - stage: test
          script: xcodebuild -project ios-app-on-travis.xcodeproj -scheme ios-app-on-travisTests -sdk iphonesimulator test
        - stage: deploy
          if: branch = master
          script: echo 'deploying...'
        - stage: archive
          script: xcodebuild -project ios-app-on-travis.xcodeproj -scheme ios-app-on-travis -archivePath $PWD/build/ios-app-on-travis.xcarchive archive -sdk iphoneos CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO


stages:
  - compile
  - test
  - archive
  - deploy
